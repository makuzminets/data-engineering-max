{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.18", "generated_at": "2026-01-14T04:52:34.850602Z", "invocation_id": "58805df6-d8aa-4922-b249-c79bbed8b077", "invocation_started_at": "2026-01-14T04:52:31.741127Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.571858Z", "completed_at": "2026-01-14T04:52:34.581287Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.581653Z", "completed_at": "2026-01-14T04:52:34.581664Z"}], "thread_id": "Thread-1", "execution_time": 0.010637044906616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fraud_analytics.stg_devices", "compiled": true, "compiled_code": "-- Staging model for raw devices\n-- Device fingerprints and attributes\n\nwith source as (\n    select * from \"analytics\".\"raw\".\"devices\"\n),\n\nrenamed as (\n    select\n        -- IDs\n        device_id,\n        user_id,\n        \n        -- Device info\n        device_type,\n        os_name,\n        os_version,\n        browser_name,\n        browser_version,\n        \n        -- Fingerprint\n        device_fingerprint,\n        is_emulator,\n        is_rooted,\n        \n        -- Location\n        timezone,\n        language,\n        \n        -- Timestamps\n        first_seen_at,\n        last_seen_at\n        \n    from source\n    where device_id is not null\n)\n\nselect * from renamed", "relation_name": "\"memory\".\"main_staging\".\"stg_devices\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.583822Z", "completed_at": "2026-01-14T04:52:34.587386Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.587769Z", "completed_at": "2026-01-14T04:52:34.587778Z"}], "thread_id": "Thread-1", "execution_time": 0.005179882049560547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fraud_analytics.stg_fraud_labels", "compiled": true, "compiled_code": "-- Staging model for fraud labels\n-- Ground truth data for fraud detection\n\nwith source as (\n    select * from \"analytics\".\"raw\".\"fraud_labels\"\n),\n\nrenamed as (\n    select\n        -- IDs\n        fraud_event_id,\n        transaction_id,\n        user_id,\n        \n        -- Fraud details\n        fraud_type,\n        fraud_source,  -- 'chargeback', 'manual_review', 'ml_model', 'rule'\n        confidence_score,\n        \n        -- Resolution\n        is_confirmed,\n        reviewed_by,\n        \n        -- Timestamps\n        detected_at,\n        confirmed_at,\n        \n        -- Notes\n        notes\n        \n    from source\n)\n\nselect * from renamed", "relation_name": "\"memory\".\"main_staging\".\"stg_fraud_labels\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.589609Z", "completed_at": "2026-01-14T04:52:34.593051Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.593404Z", "completed_at": "2026-01-14T04:52:34.593413Z"}], "thread_id": "Thread-1", "execution_time": 0.00467681884765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fraud_analytics.stg_transactions", "compiled": true, "compiled_code": "-- Staging model for raw transactions\n-- Cleans and standardizes transaction data\n\nwith source as (\n    select * from \"analytics\".\"raw\".\"transactions\"\n),\n\nrenamed as (\n    select\n        -- IDs\n        transaction_id,\n        user_id,\n        device_id,\n        \n        -- Transaction details\n        amount,\n        currency,\n        transaction_type,\n        payment_method,\n        \n        -- Status\n        status,\n        is_successful,\n        \n        -- Location\n        ip_address,\n        country_code,\n        city,\n        \n        -- Timestamps\n        created_at,\n        processed_at,\n        \n        -- Metadata\n        _loaded_at\n        \n    from source\n    where transaction_id is not null\n)\n\nselect * from renamed", "relation_name": "\"memory\".\"main_staging\".\"stg_transactions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.595268Z", "completed_at": "2026-01-14T04:52:34.598710Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.599071Z", "completed_at": "2026-01-14T04:52:34.599079Z"}], "thread_id": "Thread-1", "execution_time": 0.004760026931762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fraud_analytics.stg_users", "compiled": true, "compiled_code": "-- Staging model for raw users\n-- Cleans and standardizes user data\n\nwith source as (\n    select * from \"analytics\".\"raw\".\"users\"\n),\n\nrenamed as (\n    select\n        -- IDs\n        user_id,\n        \n        -- User info\n        email,\n        phone_hash,\n        \n        -- Account details\n        account_status,\n        is_verified,\n        verification_level,\n        \n        -- Registration\n        signup_source,\n        signup_country,\n        signup_device_type,\n        \n        -- Timestamps\n        created_at as registered_at,\n        last_login_at,\n        \n        -- Calculated fields\n        current_timestamp() as _refreshed_at\n        \n    from source\n    where user_id is not null\n)\n\nselect * from renamed", "relation_name": "\"memory\".\"main_staging\".\"stg_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.601118Z", "completed_at": "2026-01-14T04:52:34.609934Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.610296Z", "completed_at": "2026-01-14T04:52:34.610305Z"}], "thread_id": "Thread-1", "execution_time": 0.01018524169921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.not_null_stg_devices_device_id.1dea87303d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom \"memory\".\"main_staging\".\"stg_devices\"\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.611997Z", "completed_at": "2026-01-14T04:52:34.619817Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.620180Z", "completed_at": "2026-01-14T04:52:34.620189Z"}], "thread_id": "Thread-1", "execution_time": 0.008996009826660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.unique_stg_devices_device_id.73b62efd0d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    device_id as unique_field,\n    count(*) as n_records\n\nfrom \"memory\".\"main_staging\".\"stg_devices\"\nwhere device_id is not null\ngroup by device_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.621902Z", "completed_at": "2026-01-14T04:52:34.626353Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.626720Z", "completed_at": "2026-01-14T04:52:34.626728Z"}], "thread_id": "Thread-1", "execution_time": 0.005638837814331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.accepted_values_stg_fraud_labels_fraud_type__chargeback__account_takeover__synthetic_identity__friendly_fraud__card_testing.7d1c52fb82", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        fraud_type as value_field,\n        count(*) as n_records\n\n    from \"memory\".\"main_staging\".\"stg_fraud_labels\"\n    group by fraud_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'chargeback','account_takeover','synthetic_identity','friendly_fraud','card_testing'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.628386Z", "completed_at": "2026-01-14T04:52:34.632632Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.633001Z", "completed_at": "2026-01-14T04:52:34.633009Z"}], "thread_id": "Thread-1", "execution_time": 0.005502939224243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.not_null_stg_fraud_labels_fraud_event_id.8b26b94dcd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fraud_event_id\nfrom \"memory\".\"main_staging\".\"stg_fraud_labels\"\nwhere fraud_event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.634806Z", "completed_at": "2026-01-14T04:52:34.638930Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.639287Z", "completed_at": "2026-01-14T04:52:34.639295Z"}], "thread_id": "Thread-1", "execution_time": 0.005278825759887695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.unique_stg_fraud_labels_fraud_event_id.a69377f007", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    fraud_event_id as unique_field,\n    count(*) as n_records\n\nfrom \"memory\".\"main_staging\".\"stg_fraud_labels\"\nwhere fraud_event_id is not null\ngroup by fraud_event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.640944Z", "completed_at": "2026-01-14T04:52:34.644986Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.645336Z", "completed_at": "2026-01-14T04:52:34.645343Z"}], "thread_id": "Thread-1", "execution_time": 0.005187034606933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fraud_analytics.dim_devices", "compiled": true, "compiled_code": "-- Dimension table: Devices with trust scores\n-- Device fingerprints and risk attributes\n\nwith devices as (\n    select * from \"memory\".\"main_staging\".\"stg_devices\"\n),\n\ntransactions as (\n    select * from \"memory\".\"main_staging\".\"stg_transactions\"\n),\n\nfraud_labels as (\n    select * from \"memory\".\"main_staging\".\"stg_fraud_labels\"\n),\n\n-- Device transaction stats\ndevice_txn_stats as (\n    select\n        device_id,\n        count(*) as transaction_count,\n        count(distinct user_id) as unique_users,\n        sum(amount) as total_amount,\n        min(created_at) as first_transaction_at,\n        max(created_at) as last_transaction_at\n    from transactions\n    group by device_id\n),\n\n-- Device fraud stats\ndevice_fraud_stats as (\n    select\n        t.device_id,\n        count(fl.fraud_event_id) as fraud_count\n    from transactions t\n    inner join fraud_labels fl on t.transaction_id = fl.transaction_id\n    where fl.is_confirmed = true\n    group by t.device_id\n)\n\nselect\n    -- Device identifiers\n    d.device_id,\n    d.device_fingerprint,\n    \n    -- Device info\n    d.device_type,\n    d.os_name,\n    d.os_version,\n    d.browser_name,\n    d.browser_version,\n    \n    -- Risk attributes\n    d.is_emulator,\n    d.is_rooted,\n    d.timezone,\n    d.language,\n    \n    -- Timestamps\n    d.first_seen_at,\n    d.last_seen_at,\n    \n    -- Usage stats\n    coalesce(ts.transaction_count, 0) as transaction_count,\n    coalesce(ts.unique_users, 0) as unique_users,\n    coalesce(ts.total_amount, 0) as total_amount,\n    ts.first_transaction_at,\n    ts.last_transaction_at,\n    \n    -- Fraud stats\n    coalesce(fs.fraud_count, 0) as fraud_count,\n    \n    -- Risk flags\n    case when ts.unique_users > 3 then true else false end as shared_device,\n    case when fs.fraud_count > 0 then true else false end as has_fraud_history,\n    \n    -- Device trust score (0-100, higher = more trusted)\n    greatest(0, least(100,\n        100 -\n        case when d.is_emulator then 40 else 0 end -\n        case when d.is_rooted then 30 else 0 end -\n        case when ts.unique_users > 3 then 20 else 0 end -\n        coalesce(fs.fraud_count, 0) * 10\n    )) as trust_score,\n    \n    -- Trust tier\n    case\n        when d.is_emulator or fs.fraud_count > 0 then 'untrusted'\n        when d.is_rooted or ts.unique_users > 3 then 'suspicious'\n        when ts.transaction_count > 10 and coalesce(fs.fraud_count, 0) = 0 then 'trusted'\n        else 'unknown'\n    end as trust_tier\n\nfrom devices d\nleft join device_txn_stats ts on d.device_id = ts.device_id\nleft join device_fraud_stats fs on d.device_id = fs.device_id", "relation_name": "\"memory\".\"main_marts\".\"dim_devices\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.652546Z", "completed_at": "2026-01-14T04:52:34.658220Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.658577Z", "completed_at": "2026-01-14T04:52:34.658585Z"}], "thread_id": "Thread-1", "execution_time": 0.006831169128417969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.accepted_values_stg_transactions_status__pending__completed__failed__cancelled.5dec448809", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"memory\".\"main_staging\".\"stg_transactions\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'pending','completed','failed','cancelled'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.660237Z", "completed_at": "2026-01-14T04:52:34.664310Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.664662Z", "completed_at": "2026-01-14T04:52:34.664670Z"}], "thread_id": "Thread-1", "execution_time": 0.0052449703216552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.not_null_stg_transactions_amount.3629b5421e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom \"memory\".\"main_staging\".\"stg_transactions\"\nwhere amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.666533Z", "completed_at": "2026-01-14T04:52:34.670890Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.671253Z", "completed_at": "2026-01-14T04:52:34.671261Z"}], "thread_id": "Thread-1", "execution_time": 0.005600929260253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.not_null_stg_transactions_transaction_id.1d00a8e2e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom \"memory\".\"main_staging\".\"stg_transactions\"\nwhere transaction_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.672964Z", "completed_at": "2026-01-14T04:52:34.677168Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.677522Z", "completed_at": "2026-01-14T04:52:34.677530Z"}], "thread_id": "Thread-1", "execution_time": 0.005378007888793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.not_null_stg_transactions_user_id.b541614306", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"memory\".\"main_staging\".\"stg_transactions\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.679254Z", "completed_at": "2026-01-14T04:52:34.683537Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.683898Z", "completed_at": "2026-01-14T04:52:34.683907Z"}], "thread_id": "Thread-1", "execution_time": 0.005527973175048828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.unique_stg_transactions_transaction_id.ee9a78a396", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transaction_id as unique_field,\n    count(*) as n_records\n\nfrom \"memory\".\"main_staging\".\"stg_transactions\"\nwhere transaction_id is not null\ngroup by transaction_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.685674Z", "completed_at": "2026-01-14T04:52:34.689467Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.689817Z", "completed_at": "2026-01-14T04:52:34.689825Z"}], "thread_id": "Thread-1", "execution_time": 0.005009174346923828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fraud_analytics.fct_fraud_events", "compiled": true, "compiled_code": "-- Fact table: Fraud events for analysis\n-- Confirmed and detected fraud cases\n\nwith fraud_labels as (\n    select * from \"memory\".\"main_staging\".\"stg_fraud_labels\"\n),\n\ntransactions as (\n    select * from \"memory\".\"main_staging\".\"stg_transactions\"\n),\n\nusers as (\n    select * from \"memory\".\"main_staging\".\"stg_users\"\n)\n\nselect\n    -- Fraud event identifiers\n    fl.fraud_event_id,\n    fl.transaction_id,\n    fl.user_id,\n    \n    -- Fraud details\n    fl.fraud_type,\n    fl.fraud_source,\n    fl.confidence_score,\n    fl.is_confirmed,\n    fl.reviewed_by,\n    fl.notes,\n    \n    -- Timestamps\n    fl.detected_at,\n    fl.confirmed_at,\n    \n    -- Detection latency\n    timestamp_diff(fl.detected_at, t.created_at, hour) as detection_latency_hours,\n    \n    -- Transaction context\n    t.amount as transaction_amount,\n    t.currency,\n    t.payment_method,\n    t.country_code,\n    t.created_at as transaction_at,\n    \n    -- User context\n    u.account_status,\n    u.is_verified,\n    u.signup_source,\n    u.registered_at as user_registered_at,\n    date_diff(date(t.created_at), date(u.registered_at), day) as account_age_at_fraud,\n    \n    -- Time dimensions\n    date(fl.detected_at) as detected_date,\n    extract(month from fl.detected_at) as detected_month,\n    extract(year from fl.detected_at) as detected_year\n\nfrom fraud_labels fl\nleft join transactions t on fl.transaction_id = t.transaction_id\nleft join users u on fl.user_id = u.user_id", "relation_name": "\"memory\".\"main_marts\".\"fct_fraud_events\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.697555Z", "completed_at": "2026-01-14T04:52:34.703354Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.703736Z", "completed_at": "2026-01-14T04:52:34.703745Z"}], "thread_id": "Thread-1", "execution_time": 0.007061004638671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.accepted_values_stg_users_account_status__active__suspended__banned__deleted.3011efbb1c", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from \"memory\".\"main_staging\".\"stg_users\"\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','suspended','banned','deleted'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.705393Z", "completed_at": "2026-01-14T04:52:34.709573Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.709918Z", "completed_at": "2026-01-14T04:52:34.709926Z"}], "thread_id": "Thread-1", "execution_time": 0.005300998687744141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.not_null_stg_users_user_id.980dfc1b77", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"memory\".\"main_staging\".\"stg_users\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.711549Z", "completed_at": "2026-01-14T04:52:34.715729Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.716080Z", "completed_at": "2026-01-14T04:52:34.716088Z"}], "thread_id": "Thread-1", "execution_time": 0.005330085754394531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.unique_stg_users_user_id.c2ff477e6b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom \"memory\".\"main_staging\".\"stg_users\"\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.717922Z", "completed_at": "2026-01-14T04:52:34.722378Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.722744Z", "completed_at": "2026-01-14T04:52:34.722752Z"}], "thread_id": "Thread-1", "execution_time": 0.005663156509399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.accepted_values_dim_devices_trust_tier__trusted__suspicious__untrusted__unknown.cab68baaa9", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        trust_tier as value_field,\n        count(*) as n_records\n\n    from \"memory\".\"main_marts\".\"dim_devices\"\n    group by trust_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'trusted','suspicious','untrusted','unknown'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.724423Z", "completed_at": "2026-01-14T04:52:34.728546Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.728892Z", "completed_at": "2026-01-14T04:52:34.728900Z"}], "thread_id": "Thread-1", "execution_time": 0.005251646041870117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.not_null_dim_devices_device_id.fa10a195c1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom \"memory\".\"main_marts\".\"dim_devices\"\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.730541Z", "completed_at": "2026-01-14T04:52:34.735071Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.735426Z", "completed_at": "2026-01-14T04:52:34.735435Z"}], "thread_id": "Thread-1", "execution_time": 0.005698680877685547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.unique_dim_devices_device_id.1c44b7d79d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    device_id as unique_field,\n    count(*) as n_records\n\nfrom \"memory\".\"main_marts\".\"dim_devices\"\nwhere device_id is not null\ngroup by device_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.737310Z", "completed_at": "2026-01-14T04:52:34.741704Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.742061Z", "completed_at": "2026-01-14T04:52:34.742069Z"}], "thread_id": "Thread-1", "execution_time": 0.005747079849243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.not_null_fct_fraud_events_fraud_event_id.828a8fc0c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fraud_event_id\nfrom \"memory\".\"main_marts\".\"fct_fraud_events\"\nwhere fraud_event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.743805Z", "completed_at": "2026-01-14T04:52:34.749500Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.749985Z", "completed_at": "2026-01-14T04:52:34.749994Z"}], "thread_id": "Thread-1", "execution_time": 0.007071018218994141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.unique_fct_fraud_events_fraud_event_id.78d78e5633", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    fraud_event_id as unique_field,\n    count(*) as n_records\n\nfrom \"memory\".\"main_marts\".\"fct_fraud_events\"\nwhere fraud_event_id is not null\ngroup by fraud_event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.751706Z", "completed_at": "2026-01-14T04:52:34.765469Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.765820Z", "completed_at": "2026-01-14T04:52:34.765828Z"}], "thread_id": "Thread-1", "execution_time": 0.014906883239746094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fraud_analytics.dim_users", "compiled": true, "compiled_code": "-- Dimension table: Users with risk profile\n-- User attributes and aggregated risk signals\n\nwith  __dbt__cte__int_user_risk_signals as (\n-- Intermediate model: User risk signals\n-- Aggregates user behavior patterns for risk assessment\n\nwith users as (\n    select * from \"memory\".\"main_staging\".\"stg_users\"\n),\n\ntransactions as (\n    select * from \"memory\".\"main_staging\".\"stg_transactions\"\n),\n\ndevices as (\n    select * from \"memory\".\"main_staging\".\"stg_devices\"\n),\n\nfraud_labels as (\n    select * from \"memory\".\"main_staging\".\"stg_fraud_labels\"\n),\n\n-- User transaction stats\nuser_txn_stats as (\n    select\n        user_id,\n        count(*) as total_transactions,\n        count(case when is_successful then 1 end) as successful_transactions,\n        sum(amount) as total_amount,\n        avg(amount) as avg_amount,\n        max(amount) as max_amount,\n        min(created_at) as first_transaction_at,\n        max(created_at) as last_transaction_at,\n        count(distinct country_code) as unique_countries,\n        count(distinct device_id) as unique_devices\n    from transactions\n    group by user_id\n),\n\n-- User fraud history\nuser_fraud_stats as (\n    select\n        user_id,\n        count(*) as fraud_count,\n        count(case when is_confirmed then 1 end) as confirmed_fraud_count,\n        max(detected_at) as last_fraud_at\n    from fraud_labels\n    group by user_id\n),\n\n-- Device risk signals\nuser_device_risk as (\n    select\n        user_id,\n        count(*) as device_count,\n        count(case when is_emulator then 1 end) as emulator_count,\n        count(case when is_rooted then 1 end) as rooted_count\n    from devices\n    group by user_id\n)\n\nselect\n    u.user_id,\n    u.account_status,\n    u.is_verified,\n    u.verification_level,\n    u.signup_source,\n    u.signup_country,\n    u.registered_at,\n    u.last_login_at,\n    \n    -- Account age\n    date_diff(current_date(), date(u.registered_at), day) as account_age_days,\n    \n    -- Transaction behavior\n    coalesce(ts.total_transactions, 0) as total_transactions,\n    coalesce(ts.successful_transactions, 0) as successful_transactions,\n    coalesce(ts.total_amount, 0) as total_amount,\n    coalesce(ts.avg_amount, 0) as avg_amount,\n    coalesce(ts.unique_countries, 0) as unique_countries,\n    coalesce(ts.unique_devices, 0) as unique_devices,\n    \n    -- Fraud history\n    coalesce(fs.fraud_count, 0) as fraud_count,\n    coalesce(fs.confirmed_fraud_count, 0) as confirmed_fraud_count,\n    fs.last_fraud_at,\n    \n    -- Device risk\n    coalesce(dr.device_count, 0) as device_count,\n    coalesce(dr.emulator_count, 0) as emulator_count,\n    coalesce(dr.rooted_count, 0) as rooted_count,\n    \n    -- Risk flags\n    case when fs.confirmed_fraud_count > 0 then true else false end as has_fraud_history,\n    case when dr.emulator_count > 0 then true else false end as uses_emulator,\n    case when ts.unique_countries > 5 then true else false end as multi_country_user,\n    case when ts.unique_devices > 10 then true else false end as multi_device_user,\n    case \n        when date_diff(current_date(), date(u.registered_at), day) < 7 \n        then true else false \n    end as is_new_account,\n    \n    -- Risk score (simple rule-based)\n    (\n        case when fs.confirmed_fraud_count > 0 then 30 else 0 end +\n        case when dr.emulator_count > 0 then 20 else 0 end +\n        case when dr.rooted_count > 0 then 15 else 0 end +\n        case when ts.unique_countries > 5 then 10 else 0 end +\n        case when ts.unique_devices > 10 then 10 else 0 end +\n        case when date_diff(current_date(), date(u.registered_at), day) < 7 then 15 else 0 end\n    ) as risk_score\n\nfrom users u\nleft join user_txn_stats ts on u.user_id = ts.user_id\nleft join user_fraud_stats fs on u.user_id = fs.user_id\nleft join user_device_risk dr on u.user_id = dr.user_id\n), user_risk as (\n    select * from __dbt__cte__int_user_risk_signals\n)\n\nselect\n    -- User identifiers\n    user_id,\n    \n    -- Account info\n    account_status,\n    is_verified,\n    verification_level,\n    signup_source,\n    signup_country,\n    \n    -- Timestamps\n    registered_at,\n    last_login_at,\n    account_age_days,\n    \n    -- Transaction behavior\n    total_transactions,\n    successful_transactions,\n    total_amount,\n    avg_amount,\n    unique_countries,\n    unique_devices,\n    \n    -- Fraud history\n    fraud_count,\n    confirmed_fraud_count,\n    last_fraud_at,\n    has_fraud_history,\n    \n    -- Device risk\n    device_count,\n    emulator_count,\n    rooted_count,\n    uses_emulator,\n    \n    -- Risk flags\n    multi_country_user,\n    multi_device_user,\n    is_new_account,\n    \n    -- Risk score\n    risk_score,\n    \n    -- Risk tier\n    case\n        when risk_score >= 50 then 'high'\n        when risk_score >= 25 then 'medium'\n        else 'low'\n    end as risk_tier,\n    \n    -- User segment\n    case\n        when confirmed_fraud_count > 0 then 'fraudster'\n        when risk_score >= 50 then 'high_risk'\n        when is_new_account and risk_score >= 25 then 'suspicious_new'\n        when total_transactions > 100 and fraud_count = 0 then 'trusted'\n        else 'standard'\n    end as user_segment\n\nfrom user_risk", "relation_name": "\"memory\".\"main_marts\".\"dim_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.767786Z", "completed_at": "2026-01-14T04:52:34.789941Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.790294Z", "completed_at": "2026-01-14T04:52:34.790308Z"}], "thread_id": "Thread-1", "execution_time": 0.023453950881958008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fraud_analytics.fct_transactions", "compiled": true, "compiled_code": "-- Fact table: Transactions with fraud features and risk scores\n-- Final table for analytics and BI\n\nwith  __dbt__cte__int_transaction_features as (\n-- Intermediate model: Transaction features for fraud detection\n-- Calculates velocity, patterns, and risk signals per transaction\n\nwith transactions as (\n    select * from \"memory\".\"main_staging\".\"stg_transactions\"\n),\n\n-- Transaction velocity: count transactions in time windows\nvelocity as (\n    select\n        transaction_id,\n        user_id,\n        created_at,\n        \n        -- Transactions in last 1 hour\n        count(*) over (\n            partition by user_id \n            order by created_at \n            range between interval 1 hour preceding and current row\n        ) as txn_count_1h,\n        \n        -- Transactions in last 24 hours\n        count(*) over (\n            partition by user_id \n            order by created_at \n            range between interval 24 hour preceding and current row\n        ) as txn_count_24h,\n        \n        -- Sum amount in last 24 hours\n        sum(amount) over (\n            partition by user_id \n            order by created_at \n            range between interval 24 hour preceding and current row\n        ) as amount_sum_24h,\n        \n        -- Average amount for user (all time)\n        avg(amount) over (partition by user_id) as user_avg_amount\n        \n    from transactions\n),\n\n-- Time-based features\ntime_features as (\n    select\n        transaction_id,\n        extract(hour from created_at) as hour_of_day,\n        extract(dayofweek from created_at) as day_of_week,\n        \n        -- Is night transaction (high risk hours)\n        case \n            when extract(hour from created_at) between 0 and 5 then true\n            else false\n        end as is_night_transaction,\n        \n        -- Is weekend\n        case \n            when extract(dayofweek from created_at) in (1, 7) then true\n            else false\n        end as is_weekend\n        \n    from transactions\n),\n\n-- Amount anomaly features\namount_features as (\n    select\n        t.transaction_id,\n        t.amount,\n        \n        -- Is round amount (suspicious pattern)\n        case \n            when mod(t.amount, 100) = 0 then true\n            else false\n        end as is_round_amount,\n        \n        -- Amount deviation from user average\n        case \n            when v.user_avg_amount > 0 \n            then (t.amount - v.user_avg_amount) / v.user_avg_amount\n            else 0\n        end as amount_deviation_ratio\n        \n    from transactions t\n    left join velocity v on t.transaction_id = v.transaction_id\n)\n\nselect\n    t.transaction_id,\n    t.user_id,\n    t.device_id,\n    t.amount,\n    t.currency,\n    t.payment_method,\n    t.country_code,\n    t.created_at,\n    \n    -- Velocity features\n    v.txn_count_1h,\n    v.txn_count_24h,\n    v.amount_sum_24h,\n    v.user_avg_amount,\n    \n    -- Time features\n    tf.hour_of_day,\n    tf.day_of_week,\n    tf.is_night_transaction,\n    tf.is_weekend,\n    \n    -- Amount features\n    af.is_round_amount,\n    af.amount_deviation_ratio,\n    \n    -- Risk signals\n    case when v.txn_count_1h > 5 then true else false end as high_velocity_1h,\n    case when v.txn_count_24h > 20 then true else false end as high_velocity_24h,\n    case when af.amount_deviation_ratio > 3 then true else false end as unusual_amount\n\nfrom transactions t\nleft join velocity v on t.transaction_id = v.transaction_id\nleft join time_features tf on t.transaction_id = tf.transaction_id\nleft join amount_features af on t.transaction_id = af.transaction_id\n),  __dbt__cte__int_user_risk_signals as (\n-- Intermediate model: User risk signals\n-- Aggregates user behavior patterns for risk assessment\n\nwith users as (\n    select * from \"memory\".\"main_staging\".\"stg_users\"\n),\n\ntransactions as (\n    select * from \"memory\".\"main_staging\".\"stg_transactions\"\n),\n\ndevices as (\n    select * from \"memory\".\"main_staging\".\"stg_devices\"\n),\n\nfraud_labels as (\n    select * from \"memory\".\"main_staging\".\"stg_fraud_labels\"\n),\n\n-- User transaction stats\nuser_txn_stats as (\n    select\n        user_id,\n        count(*) as total_transactions,\n        count(case when is_successful then 1 end) as successful_transactions,\n        sum(amount) as total_amount,\n        avg(amount) as avg_amount,\n        max(amount) as max_amount,\n        min(created_at) as first_transaction_at,\n        max(created_at) as last_transaction_at,\n        count(distinct country_code) as unique_countries,\n        count(distinct device_id) as unique_devices\n    from transactions\n    group by user_id\n),\n\n-- User fraud history\nuser_fraud_stats as (\n    select\n        user_id,\n        count(*) as fraud_count,\n        count(case when is_confirmed then 1 end) as confirmed_fraud_count,\n        max(detected_at) as last_fraud_at\n    from fraud_labels\n    group by user_id\n),\n\n-- Device risk signals\nuser_device_risk as (\n    select\n        user_id,\n        count(*) as device_count,\n        count(case when is_emulator then 1 end) as emulator_count,\n        count(case when is_rooted then 1 end) as rooted_count\n    from devices\n    group by user_id\n)\n\nselect\n    u.user_id,\n    u.account_status,\n    u.is_verified,\n    u.verification_level,\n    u.signup_source,\n    u.signup_country,\n    u.registered_at,\n    u.last_login_at,\n    \n    -- Account age\n    date_diff(current_date(), date(u.registered_at), day) as account_age_days,\n    \n    -- Transaction behavior\n    coalesce(ts.total_transactions, 0) as total_transactions,\n    coalesce(ts.successful_transactions, 0) as successful_transactions,\n    coalesce(ts.total_amount, 0) as total_amount,\n    coalesce(ts.avg_amount, 0) as avg_amount,\n    coalesce(ts.unique_countries, 0) as unique_countries,\n    coalesce(ts.unique_devices, 0) as unique_devices,\n    \n    -- Fraud history\n    coalesce(fs.fraud_count, 0) as fraud_count,\n    coalesce(fs.confirmed_fraud_count, 0) as confirmed_fraud_count,\n    fs.last_fraud_at,\n    \n    -- Device risk\n    coalesce(dr.device_count, 0) as device_count,\n    coalesce(dr.emulator_count, 0) as emulator_count,\n    coalesce(dr.rooted_count, 0) as rooted_count,\n    \n    -- Risk flags\n    case when fs.confirmed_fraud_count > 0 then true else false end as has_fraud_history,\n    case when dr.emulator_count > 0 then true else false end as uses_emulator,\n    case when ts.unique_countries > 5 then true else false end as multi_country_user,\n    case when ts.unique_devices > 10 then true else false end as multi_device_user,\n    case \n        when date_diff(current_date(), date(u.registered_at), day) < 7 \n        then true else false \n    end as is_new_account,\n    \n    -- Risk score (simple rule-based)\n    (\n        case when fs.confirmed_fraud_count > 0 then 30 else 0 end +\n        case when dr.emulator_count > 0 then 20 else 0 end +\n        case when dr.rooted_count > 0 then 15 else 0 end +\n        case when ts.unique_countries > 5 then 10 else 0 end +\n        case when ts.unique_devices > 10 then 10 else 0 end +\n        case when date_diff(current_date(), date(u.registered_at), day) < 7 then 15 else 0 end\n    ) as risk_score\n\nfrom users u\nleft join user_txn_stats ts on u.user_id = ts.user_id\nleft join user_fraud_stats fs on u.user_id = fs.user_id\nleft join user_device_risk dr on u.user_id = dr.user_id\n), transaction_features as (\n    select * from __dbt__cte__int_transaction_features\n),\n\nuser_risk as (\n    select * from __dbt__cte__int_user_risk_signals\n),\n\nfraud_labels as (\n    select * from \"memory\".\"main_staging\".\"stg_fraud_labels\"\n)\n\nselect\n    -- Transaction identifiers\n    tf.transaction_id,\n    tf.user_id,\n    tf.device_id,\n    \n    -- Transaction details\n    tf.amount,\n    tf.currency,\n    tf.payment_method,\n    tf.country_code,\n    tf.created_at,\n    \n    -- Transaction features\n    tf.txn_count_1h,\n    tf.txn_count_24h,\n    tf.amount_sum_24h,\n    tf.hour_of_day,\n    tf.is_night_transaction,\n    tf.is_weekend,\n    tf.is_round_amount,\n    tf.amount_deviation_ratio,\n    \n    -- Transaction risk flags\n    tf.high_velocity_1h,\n    tf.high_velocity_24h,\n    tf.unusual_amount,\n    \n    -- User risk context\n    ur.account_age_days,\n    ur.total_transactions as user_total_transactions,\n    ur.fraud_count as user_fraud_count,\n    ur.risk_score as user_risk_score,\n    ur.has_fraud_history,\n    ur.is_new_account,\n    \n    -- Fraud outcome (if known)\n    case when fl.fraud_event_id is not null then true else false end as is_fraud,\n    fl.fraud_type,\n    fl.fraud_source,\n    fl.confidence_score as fraud_confidence,\n    \n    -- Combined risk score\n    (\n        ur.risk_score +\n        case when tf.high_velocity_1h then 15 else 0 end +\n        case when tf.high_velocity_24h then 10 else 0 end +\n        case when tf.unusual_amount then 20 else 0 end +\n        case when tf.is_night_transaction then 5 else 0 end\n    ) as transaction_risk_score,\n    \n    -- Risk tier\n    case\n        when (ur.risk_score + \n              case when tf.high_velocity_1h then 15 else 0 end +\n              case when tf.unusual_amount then 20 else 0 end) >= 50 then 'high'\n        when (ur.risk_score + \n              case when tf.high_velocity_1h then 15 else 0 end +\n              case when tf.unusual_amount then 20 else 0 end) >= 25 then 'medium'\n        else 'low'\n    end as risk_tier\n\nfrom transaction_features tf\nleft join user_risk ur on tf.user_id = ur.user_id\nleft join fraud_labels fl on tf.transaction_id = fl.transaction_id", "relation_name": "\"memory\".\"main_marts\".\"fct_transactions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.792224Z", "completed_at": "2026-01-14T04:52:34.796492Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.796852Z", "completed_at": "2026-01-14T04:52:34.796860Z"}], "thread_id": "Thread-1", "execution_time": 0.005620002746582031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.accepted_values_dim_users_risk_tier__low__medium__high.3b4a87df49", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        risk_tier as value_field,\n        count(*) as n_records\n\n    from \"memory\".\"main_marts\".\"dim_users\"\n    group by risk_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'low','medium','high'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.798581Z", "completed_at": "2026-01-14T04:52:34.803139Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.803503Z", "completed_at": "2026-01-14T04:52:34.803511Z"}], "thread_id": "Thread-1", "execution_time": 0.005742073059082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.accepted_values_dim_users_user_segment__fraudster__high_risk__suspicious_new__trusted__standard.f71cf9e0d5", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        user_segment as value_field,\n        count(*) as n_records\n\n    from \"memory\".\"main_marts\".\"dim_users\"\n    group by user_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'fraudster','high_risk','suspicious_new','trusted','standard'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.805191Z", "completed_at": "2026-01-14T04:52:34.810714Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.811065Z", "completed_at": "2026-01-14T04:52:34.811073Z"}], "thread_id": "Thread-1", "execution_time": 0.0066890716552734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.not_null_dim_users_user_id.e754bb5812", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"memory\".\"main_marts\".\"dim_users\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.812693Z", "completed_at": "2026-01-14T04:52:34.816970Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.817323Z", "completed_at": "2026-01-14T04:52:34.817331Z"}], "thread_id": "Thread-1", "execution_time": 0.0054090023040771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.unique_dim_users_user_id.bcdc17b9f9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom \"memory\".\"main_marts\".\"dim_users\"\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.818988Z", "completed_at": "2026-01-14T04:52:34.823183Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.823541Z", "completed_at": "2026-01-14T04:52:34.823549Z"}], "thread_id": "Thread-1", "execution_time": 0.005341053009033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.accepted_values_fct_transactions_risk_tier__low__medium__high.780b279c36", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        risk_tier as value_field,\n        count(*) as n_records\n\n    from \"memory\".\"main_marts\".\"fct_transactions\"\n    group by risk_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'low','medium','high'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.825191Z", "completed_at": "2026-01-14T04:52:34.829260Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.829613Z", "completed_at": "2026-01-14T04:52:34.829621Z"}], "thread_id": "Thread-1", "execution_time": 0.005209922790527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.not_null_fct_transactions_transaction_id.2c6b5372aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom \"memory\".\"main_marts\".\"fct_transactions\"\nwhere transaction_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.831247Z", "completed_at": "2026-01-14T04:52:34.835524Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.835877Z", "completed_at": "2026-01-14T04:52:34.835886Z"}], "thread_id": "Thread-1", "execution_time": 0.005414724349975586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.not_null_fct_transactions_user_id.b48a6b184c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"memory\".\"main_marts\".\"fct_transactions\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.837538Z", "completed_at": "2026-01-14T04:52:34.842438Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.842798Z", "completed_at": "2026-01-14T04:52:34.842806Z"}], "thread_id": "Thread-1", "execution_time": 0.0060498714447021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.relationships_fct_transactions_user_id__user_id__ref_dim_users_.237e9dc92f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from \"memory\".\"main_marts\".\"fct_transactions\"\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from \"memory\".\"main_marts\".\"dim_users\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-14T04:52:34.844436Z", "completed_at": "2026-01-14T04:52:34.848500Z"}, {"name": "execute", "started_at": "2026-01-14T04:52:34.848851Z", "completed_at": "2026-01-14T04:52:34.848859Z"}], "thread_id": "Thread-1", "execution_time": 0.005201101303100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fraud_analytics.unique_fct_transactions_transaction_id.c963611c53", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transaction_id as unique_field,\n    count(*) as n_records\n\nfrom \"memory\".\"main_marts\".\"fct_transactions\"\nwhere transaction_id is not null\ngroup by transaction_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.39131593704223633, "args": {"show_all_deprecations": false, "project_dir": "/Users/maksim/repos/data-engineering-max/dbt_fraud_analytics", "empty_catalog": false, "vars": {}, "require_resource_names_without_spaces": true, "select": [], "printer_width": 80, "require_yaml_configuration_for_mf_time_spines": false, "log_level": "info", "upload_to_artifacts_ingest_api": false, "cache_selected_only": false, "introspect": true, "profiles_dir": ".", "require_nested_cumulative_type_params": false, "indirect_selection": "eager", "print": true, "use_colors_file": true, "skip_nodes_if_on_run_start_fails": false, "log_file_max_bytes": 10485760, "require_batched_execution_for_custom_microbatch_strategy": false, "version_check": true, "static": false, "show_resource_report": false, "log_level_file": "debug", "log_path": "/Users/maksim/repos/data-engineering-max/dbt_fraud_analytics/logs", "populate_cache": true, "require_all_warnings_handled_by_warn_error": false, "compile": true, "quiet": false, "use_colors": true, "require_explicit_package_overrides_for_builtin_materializations": true, "strict_mode": false, "state_modified_compare_more_unrendered_values": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "favor_state": false, "partial_parse_file_diff": true, "which": "generate", "partial_parse": true, "invocation_command": "dbt docs generate --profiles-dir .", "validate_macro_args": false, "macro_debugging": false, "use_fast_test_edges": false, "defer": false, "send_anonymous_usage_stats": true, "log_format_file": "debug", "exclude": [], "write_json": true, "state_modified_compare_vars": false, "static_parser": true, "source_freshness_run_project_hooks": true, "require_generic_test_arguments_property": true, "log_format": "default"}}